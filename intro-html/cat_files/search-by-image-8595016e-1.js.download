import{_ as o}from"./preload-helper-be1680a6-1.js";import{r as c}from"./stimulus-helpers-c43cc3fa-1.js";import{E as h}from"./ez-base-controller-b85d3e67-1.js";import{i as g}from"./tooltips-a1b64de7-1.js";import{t as s}from"./helpers-b048f46c-1.js";import{S as l,b as p}from"./ez-custom-events-cfc2257b-1.js";import{a as d}from"./ajax-helpers-8ccbd67f-1.js";import"./performance-helpers-20b701c9-1.js";import"./js-5386754e-1.js";import"./_commonjsHelpers-de833af9-1.js";import"./init-user-58d04eb1-1.js";import"./index-fb2f77fe-1.js";import"./modal_helpers-a5e93c11-1.js";import"https://unpkg.com/comlink/dist/esm/comlink.mjs";const u='<div class="ez-spinner ez-spinner--color-mono"></div>';class i extends h{constructor(){super(...arguments),this.mobileTriggerSearchByImage=()=>{this.targetTarget.click()},this.loadSearchByImageFormError=()=>{s(l)},this.clearSearchByImageDragDrop=()=>{s(p)}}connect(){g(".search-by-image__open",{extraWrapperClass:"search-by-image-trigger-tooltip"}),this.initSearchByImage()}disconnect(){this.searchByImageTooltipInitialized=!1}loadSearchByImageForm(){setTimeout(()=>{var e;(e=this.popper)!=null&&e.querySelector(".search-by-image__choose-file__url-area")?requestAnimationFrame(()=>{var r;(r=this.instanceTarget)==null||r.classList.remove("is-loading")}):d("/search_by_image_form",r=>{requestAnimationFrame(()=>{var a;this.popper.querySelector(".tippy-content").innerHTML=r.data,(a=this.instanceTarget)==null||a.classList.remove("is-loading")})},()=>{requestAnimationFrame(()=>{this.loadSearchByImageFormError()})})}),this.hasTriggerParentTarget&&requestAnimationFrame(()=>{this.triggerParentTarget.classList.add("has-search-by-image-ui")}),this.hasSearchInputTarget&&(this.backupSearchPlaceholder=this.searchInputTarget.placeholder,this.searchInputTarget.placeholder=this.placeholderValue)}hideSearchByImageForm(){var e;(e=this.instanceTarget)==null||e.classList.remove("is-active"),this.hasTriggerParentTarget&&this.triggerParentTarget.classList.remove("has-search-by-image-ui"),this.hasSearchInputTarget&&(this.searchInputTarget.placeholder=this.backupSearchPlaceholder),this.element.querySelector(".search-by-image__choose-file__url-area")&&(this.element.removeAttribute("data-disable-form-submit"),this.clearSearchByImageDragDrop()),setTimeout(()=>{var r;(r=this.instanceTarget)==null||r.classList.remove("is-loading")})}initSearchByImage(){if(!this.searchByImageTooltipInitialized){const e=this,r=this.hasTriggerParentTarget?this.triggerParentTarget:"parent";o(()=>import("./tippy-a79def68-1.js"),[]).then(a=>{const n=a.default;n(this.targetTargets,{content:u,allowHTML:!0,animation:"rising",interactive:!0,appendTo:r,placement:"bottom-end",theme:"search-by-image",delay:[0,null],duration:0,maxWidth:"none",offset:[0,10],trigger:"click",popperOptions:{modifiers:[{name:"flip",enabled:!1}]},onCreate(t){t.popper.classList.add("search-by-image-tooltip")},onTrigger(t,m){e.element.setAttribute("data-disable-form-submit","true"),e.urlField=t.popper.querySelector('[data-search-by-image-target="urlField"]'),e.instanceTarget=m.currentTarget,requestAnimationFrame(()=>{e.instanceTarget.classList.add("is-active")})},onShow(t){e.popper=t.popper,requestAnimationFrame(()=>{e.loadSearchByImageForm()})},onHide(t){e.popper=t.popper,requestAnimationFrame(()=>{e.hideSearchByImageForm()})}}),this.searchByImageTooltipInitialized=!0})}}}i.targets=["searchInput","triggerParent","target"];i.values={verticalOffset:Number,placeholder:String};c([["search-by-image",i],["search-by-image-drag-drop",o(()=>import("./search-by-image-drag-drop-controller-2b9c9cb3-1.js"),[])]]);
